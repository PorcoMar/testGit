!function(){function e(e){if(location.search){var t=new RegExp(e+"=([^&$]+)"),n=location.search.match(t);return n&&n[1]?n[1]:""}return""}var t=document.getElementById("bind"),n=document.getElementById("usrname"),a=document.getElementById("password"),r=document.getElementById("download"),o=/^0?(13|14|15|18|17)[0-9]{9}$/,s=/^\w+((-w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,u={40200:"手机号没有注册",40201:"邮箱没有注册",40202:"密码错误",40900:"该账号已经绑定其他微信号",40901:"该微信号已经被其他账户绑定"};if("undefined"==typeof c)var c=function(){};t.addEventListener("click",function(){function t(e){function t(e){var t=[];for(var n in e)t.push(n+"="+e[n]);return t.join("&")}e=e||{},e.type=(e.type||"GET").toUpperCase(),e.data=e.data||{},e.header=e.header||{};var n=null;n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),"POST"==e.type?(n.open(e.type,e.url,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.data=t(e.data)):"GET"==e.type&&(e.url+="?"+t(e.data),n.open(e.type,e.url,!0),e.data=null);for(var a in e.header)n.setRequestHeader(a,e.header[a]);n.onreadystatechange=function(){4==n.readyState&&200==n.status&&(/^\{(?:.*)\}$/.test(n.responseText)?e.success&&e.success.call(n,JSON.parse(n.responseText)):e.success&&e.success.call(n,n.responseText))},n.send(e.data)}var r=n.value.replace(/\s+/,""),d=a.value.replace(/\s+/,"");if(!r||!d)return alert("用户名或密码不能为空");if(!o.test(r)&&!s.test(r))return alert("用户名格式不正确");var i="phone";o.test(r)?i="phone":s.test(r)&&(i="email");var l=e("openId"),p=e("unionId"),f=e("menuUrl");if(!l&&!p)return alert("缺少必要参数");var w={account:r,accountType:i,password:md5(d),openId:l,unionId:p};t({url:"http://api.tinman.cn/jojosherlock/v1/wechat/setUserOpenId",type:"POST",data:w,success:function(e){200==e.status?(c("wx_noaccoun_bind_ok","没有账户时点击菜单弹出页面"),location.replace("http://api.tinman.cn/jojosherlock/web/autoBuyResult.html?"+["userId="+e.data.userId,"openId="+l,"unionId="+p,"menuUrl="+f].join("&"))):alert(e.status in u?u[e.status]:e.info)}})}),r&&r.addEventListener("click",function(){return c("wx_noaccoun_down","没有账户时点击菜单弹出页面"),!0})}();